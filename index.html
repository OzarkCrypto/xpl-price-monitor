<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XPL ê°€ê²© ëª¨ë‹ˆí„°</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
            <style>
            body { 
                background: #000000; 
                min-height: 100vh; 
                color: #ffffff;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }
            .card { 
                border: 1px solid #333333; 
                border-radius: 12px; 
                background: #111111;
                box-shadow: 0 4px 20px rgba(0,0,0,0.5);
                transition: all 0.3s ease;
            }
            .card:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(0,0,0,0.7);
            }
            .price-card { 
                background: #1a1a1a; 
                color: #ffffff; 
                border: 1px solid #444444;
            }
            .price-card.hyperliquid { 
                background: #1a1a1a; 
                color: #ffffff;
                border: 1px solid #444444;
            }
            .gap-card { 
                background: #1a1a1a; 
                color: #ffffff;
                border: 1px solid #444444;
            }
            .btn-refresh { 
                background: #333333; 
                border: 1px solid #555555;
                color: #ffffff;
                transition: all 0.3s ease;
            }
            .btn-refresh:hover {
                background: #444444;
                border-color: #666666;
                transform: translateY(-1px);
            }
            .last-update { 
                color: #888888; 
                font-size: 0.9rem; 
            }
            .display-6 {
                color: #ffffff;
                font-weight: 600;
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            }
            .card-title {
                color: #cccccc;
                font-weight: 500;
            }
            .btn-outline-light {
                border-color: #666666;
                color: #cccccc;
            }
            .btn-outline-light:hover {
                background: #333333;
                border-color: #888888;
                color: #ffffff;
            }
            .text-muted {
                color: #888888 !important;
            }
        </style>
</head>
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="text-center mb-5">
                    <h1 class="display-4 text-white mb-3">ğŸš€ XPL ê°€ê²© ëª¨ë‹ˆí„°</h1>
                    <p class="lead text-white-50">Binance vs Hyperliquid ì‹¤ì‹œê°„ ê°€ê²© ë¹„êµ</p>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-6 mb-3">
                        <div class="card price-card h-100">
                            <div class="card-body text-center">
                                <h5 class="card-title">Binance Futures</h5>
                                <div class="display-6 mb-3" id="binancePrice">-</div>
                                <a href="https://www.binance.com/en/futures/XPLUSDT" target="_blank" class="btn btn-outline-light btn-sm">ê±°ë˜ì†Œ ë°©ë¬¸</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card price-card hyperliquid h-100">
                            <div class="card-body text-center">
                                <h5 class="card-title">Hyperliquid</h5>
                                <div class="display-6 mb-3" id="hyperliquidPrice">-</div>
                                <a href="https://app.hyperliquid.xyz/trade" target="_blank" class="btn btn-outline-light btn-sm">ê±°ë˜ì†Œ ë°©ë¬¸</a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-6 mb-3">
                        <div class="card gap-card h-100">
                            <div class="card-body text-center">
                                <h5 class="card-title">ì ˆëŒ€ ê°­</h5>
                                <div class="display-6 mb-3" id="absoluteGap">-</div>
                                <small class="text-white-50">USD ì°¨ì´</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card gap-card h-100">
                            <div class="card-body text-center">
                                <h5 class="card-title">ìƒëŒ€ ê°­</h5>
                                <div class="display-6 mb-3" id="relativeGap">-</div>
                                <small class="text-white-50">ë°±ë¶„ìœ¨ ì°¨ì´</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5 class="card-title">ê°­ ìƒíƒœ</h5>
                                <div class="display-6 mb-3" id="gapStatus">-</div>
                                <div id="gapDescription" class="text-muted">-</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                                    <div class="text-center mb-4">
                        <button class="btn btn-refresh btn-lg text-white" onclick="refreshPrices()">
                            ğŸ”„ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                        </button>
                        
                        <!-- í…”ë ˆê·¸ë¨ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ -->
                        <button class="btn btn-info btn-lg ms-3" onclick="testTelegramMessage()">
                            ğŸ“± í…”ë ˆê·¸ë¨ í…ŒìŠ¤íŠ¸
                        </button>
                        
                        <!-- ë´‡ ì •ë³´ í™•ì¸ ë²„íŠ¼ -->
                        <button class="btn btn-secondary btn-lg ms-3" onclick="getBotInfo()">
                            ğŸ¤– ë´‡ ì •ë³´
                        </button>
                        
                        <!-- ìƒˆ ê·¸ë£¹ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ -->
                        <button class="btn btn-warning btn-lg ms-3" onclick="testNewGroup()">
                            ğŸ†• ìƒˆ ê·¸ë£¹ í…ŒìŠ¤íŠ¸
                        </button>
                        
                        <!-- í˜„ì¬ ê°€ê²© í…ŒìŠ¤íŠ¸ ë²„íŠ¼ -->
                        <button class="btn btn-success btn-lg ms-3" onclick="testCurrentPrices()">
                            ğŸ§ª í˜„ì¬ ê°€ê²© í…ŒìŠ¤íŠ¸
                        </button>
                    </div>
                
                                    <div class="text-center mt-4">
                        <div class="row">
                            <div class="col-md-6">
                                <p class="last-update">
                                    ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: <span id="lastUpdate">-</span>
                                </p>
                            </div>
                            <div class="col-md-6">
                                <p class="last-update">
                                    <span id="secondsAgo">-</span>ì´ˆ ì „
                                </p>
                            </div>
                        </div>
                        
                        <!-- ì•Œë¦¼ ì„¤ì • ì •ë³´ -->
                        <div class="row mt-3">
                            <div class="col-12">
                                <div class="card" style="background: #0a0a0a; border-color: #333333;">
                                    <div class="card-body">
                                        <h6 class="card-title text-warning">ğŸš¨ ê¸´ê¸‰ ì•Œë¦¼ ì„¤ì •</h6>
                                        <div class="row text-center">
                                            <div class="col-md-6">
                                                <small class="text-muted">
                                                    Hyperliquid XPL â‰¥ $1.5<br>
                                                    <span class="text-info">í…”ë ˆê·¸ë¨ ì•Œë¦¼</span>
                                                </small>
                                            </div>
                                            <div class="col-md-6">
                                                <small class="text-muted">
                                                    ê°€ê²© ê°­ â‰¥ 33%<br>
                                                    <span class="text-info">í…”ë ˆê·¸ë¨ ì•Œë¦¼</span>
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
    </div>
    
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            // ìƒˆ ê·¸ë£¹ ì±„íŒ… ID
            const NEW_GROUP_CHAT_ID = '8468086404';
            
            // í…”ë ˆê·¸ë¨ ë´‡ ì„¤ì •
            const TELEGRAM_TOKEN = '8468086404:AAFe5viY6CrlqCsOqP6XKjctKxCu6qI3u1E';
            const TELEGRAM_CHAT_ID = '1339285013';
            let lastTelegramAlertTime = 0;
            const TELEGRAM_ALERT_COOLDOWN = 300000; // 5ë¶„ ì¿¨ë‹¤ìš´
            
            // íŒì—… ì•Œë¦¼ ê´€ë ¨ ë³€ìˆ˜ë“¤ ì œê±°
            let lastAlertTime = 0;
            const ALERT_COOLDOWN = 300000; // 5ë¶„ ì¿¨ë‹¤ìš´
            
            // í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡
            async function sendTelegramMessage(message) {
                try {
                    const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: TELEGRAM_CHAT_ID,
                            text: message,
                            parse_mode: 'HTML'
                        })
                    });
                    
                    const result = await response.json();
                    if (result.ok) {
                        console.log('í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ:', result);
                    } else {
                        console.error('í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:', result);
                    }
                } catch (error) {
                    console.error('í…”ë ˆê·¸ë¨ API ì˜¤ë¥˜:', error);
                }
            }
            
            // ê°­ ì•Œë¦¼
            function sendGapAlert(binancePrice, hyperliquidPrice, gapPercentage) {
                const now = Date.now();
                if (now - lastTelegramAlertTime < TELEGRAM_ALERT_COOLDOWN) {
                    return; // ì¿¨ë‹¤ìš´ ì¤‘
                }
                
                lastTelegramAlertTime = now;
                
                const message = `ğŸš¨ <b>XPL ê°€ê²© ê°­ ì•Œë¦¼</b>
 
 Binance ê°€ê²©: $${binancePrice.toFixed(6)}
 Hyperliquid ê°€ê²©: $${hyperliquidPrice.toFixed(6)}
 ê°­: ${gapPercentage.toFixed(2)}%
 
 â° ${new Date().toLocaleString('ko-KR')}`;
                
                // ê¸°ì¡´ ê·¸ë£¹ì— ì „ì†¡
                sendTelegramMessage(message);
                
                // ìƒˆ ê·¸ë£¹ì—ë„ ì „ì†¡
                sendTelegramMessageToGroup(message, NEW_GROUP_CHAT_ID);
                
                console.log('í…”ë ˆê·¸ë¨ ê°­ ì•Œë¦¼ ì „ì†¡ (ë‘ ê·¸ë£¹):', gapPercentage.toFixed(2) + '%');
            }
            
            // ê¸´ê¸‰ ì•Œë¦¼ ì²´í¬ (í…”ë ˆê·¸ë¨ë§Œ)
            function checkEmergencyAlert(binancePrice, hyperliquidPrice, gapPercentage) {
                // Hyperliquid ê°€ê²©ì´ 1.5 ì´ìƒì´ê±°ë‚˜ ê°­ì´ 33% ì´ìƒì¼ ë•Œ ê¸´ê¸‰ í…”ë ˆê·¸ë¨ ì•Œë¦¼
                if (hyperliquidPrice >= 1.5 || gapPercentage >= 33) {
                    const message = `ğŸš¨ <b>ê¸´ê¸‰ ì•Œë¦¼!</b>\n\nHyperliquid XPL: $${hyperliquidPrice.toFixed(6)}\nBinance XPL: $${binancePrice.toFixed(6)}\nê°­: ${gapPercentage.toFixed(2)}%\n\nâ° ${new Date().toLocaleString('ko-KR')}`;
                    
                    // ê¸°ì¡´ ê·¸ë£¹ì— ì „ì†¡
                    sendTelegramMessage(message);
                    
                    // ìƒˆ ê·¸ë£¹ì—ë„ ì „ì†¡
                    sendTelegramMessageToGroup(message, NEW_GROUP_CHAT_ID);
                    
                    console.log('ê¸´ê¸‰ í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì „ì†¡ (ë‘ ê·¸ë£¹):', message);
                }
            }
            
            // íŠ¹ì • ê·¸ë£¹ì— í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡
            async function sendTelegramMessageToGroup(message, chatId) {
                try {
                    const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: chatId,
                            text: message,
                            parse_mode: 'HTML'
                        })
                    });
                    
                    const result = await response.json();
                    if (result.ok) {
                        console.log(`ê·¸ë£¹ ${chatId}ì— ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ`);
                    } else {
                        console.error(`ê·¸ë£¹ ${chatId}ì— ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:`, result);
                    }
                } catch (error) {
                    console.error(`ê·¸ë£¹ ${chatId} ë©”ì‹œì§€ ì „ì†¡ ì˜¤ë¥˜:`, error);
                }
            }
            
            // ë´‡ ì •ë³´ í™•ì¸
            async function getBotInfo() {
                try {
                    const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/getMe`;
                    const response = await fetch(url);
                    const result = await response.json();
                    
                    if (result.ok) {
                        console.log('ë´‡ ì •ë³´:', result.result);
                        console.log(`ë´‡ ì •ë³´:\nì´ë¦„: ${result.result.first_name}\nì‚¬ìš©ìëª…: @${result.result.username}\nID: ${result.result.id}`);
                    } else {
                        console.error('ë´‡ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', result);
                    }
                } catch (error) {
                    console.error('ë´‡ ì •ë³´ API ì˜¤ë¥˜:', error);
                }
            }
            
            // ìƒˆ ê·¸ë£¹ì— í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡
            async function testNewGroup() {
                if (!NEW_GROUP_CHAT_ID) {
                    console.log('ìƒˆ ê·¸ë£¹ Chat IDë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”!');
                    return;
                }
                
                try {
                    const message = `ğŸ§ª <b>ìƒˆ ê·¸ë£¹ í…ŒìŠ¤íŠ¸</b>\n\nâœ… ì´ ê·¸ë£¹ì—ë„ ì•Œë¦¼ì´ ì •ìƒì ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤!\n\nâ° ${new Date().toLocaleString('ko-KR')}`;
                    
                    const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: NEW_GROUP_CHAT_ID,
                            text: message,
                            parse_mode: 'HTML'
                        })
                    });
                    
                    const result = await response.json();
                    if (result.ok) {
                        console.log('ìƒˆ ê·¸ë£¹ì— í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
                        console.log('ìƒˆ ê·¸ë£¹ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ:', result);
                    } else {
                        console.error('ìƒˆ ê·¸ë£¹ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:', result);
                    }
                } catch (error) {
                    console.error('ìƒˆ ê·¸ë£¹ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜:', error);
                }
            }
            
            // íŒì—… ì•Œë¦¼ ë¹„í™œì„±í™” - í…”ë ˆê·¸ë¨ ì•Œë¦¼ë§Œ ì‚¬ìš©
            function showAlert(message, isUrgent = false) {
                // íŒì—… ì•Œë¦¼ì€ ë¹„í™œì„±í™”í•˜ê³  í…”ë ˆê·¸ë¨ ì•Œë¦¼ë§Œ ì‚¬ìš©
                console.log('íŒì—… ì•Œë¦¼ ë¹„í™œì„±í™”ë¨:', message);
            }
        let updateInterval;
        
        async function getBinancePrice() {
            try {
                const response = await fetch('https://fapi.binance.com/fapi/v1/ticker/price?symbol=XPLUSDT');
                const data = await response.json();
                return parseFloat(data.price);
            } catch (error) {
                console.error('Binance API ì˜¤ë¥˜:', error);
                return null;
            }
        }
        
        async function getHyperliquidPrice() {
            try {
                const response = await fetch('https://api.hyperliquid.xyz/info', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type: 'allMids' })
                });
                const data = await response.json();
                return data.XPL ? parseFloat(data.XPL) : null;
            } catch (error) {
                console.error('Hyperliquid API ì˜¤ë¥˜:', error);
                return null;
            }
        }
        
        function calculateGap(binancePrice, hyperliquidPrice) {
            if (binancePrice === null || hyperliquidPrice === null) {
                return { absolute: null, percentage: null, status: 'unknown' };
            }
            
            const absoluteGap = Math.abs(hyperliquidPrice - binancePrice);
            const percentageGap = (absoluteGap / binancePrice) * 100;
            
            let status;
            if (percentageGap < 1) status = 'low';
            else if (percentageGap < 5) status = 'medium';
            else status = 'high';
            
            return {
                absolute: absoluteGap,
                percentage: percentageGap,
                status: status
            };
        }
        
        async function updatePrices() {
            const binancePrice = await getBinancePrice();
            const hyperliquidPrice = await getHyperliquidPrice();
            
            // Binance ê°€ê²© í‘œì‹œ
            if (binancePrice !== null) {
                document.getElementById('binancePrice').textContent = '$' + binancePrice.toFixed(6);
            } else {
                document.getElementById('binancePrice').textContent = 'ì˜¤ë¥˜';
            }
            
            // Hyperliquid ê°€ê²© í‘œì‹œ
            if (hyperliquidPrice !== null) {
                document.getElementById('hyperliquidPrice').textContent = '$' + hyperliquidPrice.toFixed(6);
            } else {
                document.getElementById('hyperliquidPrice').textContent = 'ì˜¤ë¥˜';
            }
            
            // ê°­ ê³„ì‚° ë° í‘œì‹œ
            const gap = calculateGap(binancePrice, hyperliquidPrice);
            
            if (gap.absolute !== null) {
                document.getElementById('absoluteGap').textContent = '$' + gap.absolute.toFixed(6);
                document.getElementById('relativeGap').textContent = gap.percentage.toFixed(2) + '%';
                
                // ê¸´ê¸‰ ì•Œë¦¼ ì²´í¬ (í…”ë ˆê·¸ë¨ë§Œ)
                checkEmergencyAlert(binancePrice, hyperliquidPrice, gap.percentage);
                
                const statusElement = document.getElementById('gapStatus');
                const descriptionElement = document.getElementById('gapDescription');
                
                if (gap.status === 'low') {
                    statusElement.textContent = 'ğŸŸ¢ ë‚®ìŒ';
                    descriptionElement.textContent = 'íš¨ìœ¨ì ì¸ ì‹œì¥';
                } else if (gap.status === 'medium') {
                    statusElement.textContent = 'ğŸŸ¡ ë³´í†µ';
                    descriptionElement.textContent = 'ì°¨ìµê±°ë˜ ê¸°íšŒ ê°€ëŠ¥';
                } else if (gap.status === 'high') {
                    statusElement.textContent = 'ğŸ”´ ë†’ìŒ';
                    descriptionElement.textContent = 'ì‹œì¥ ë¹„íš¨ìœ¨ì„±';
                }
            } else {
                document.getElementById('absoluteGap').textContent = '-';
                document.getElementById('relativeGap').textContent = '-';
                document.getElementById('gapStatus').textContent = '-';
                document.getElementById('gapDescription').textContent = '-';
            }
            
            // ì‹œê°„ ì •ë³´ ì—…ë°ì´íŠ¸
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleString('ko-KR');
            document.getElementById('secondsAgo').textContent = '0';
        }
        
        function refreshPrices() {
            updatePrices();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê°€ê²© ì—…ë°ì´íŠ¸
        document.addEventListener('DOMContentLoaded', function() {
            updatePrices();
            updateInterval = setInterval(updatePrices, 30000);
        });
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì¸í„°ë²Œ ì •ë¦¬
        window.addEventListener('beforeunload', function() {
            if (updateInterval) {
                clearInterval(updateInterval);
            }
        });

        // í˜„ì¬ ê°€ê²©ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ë³´ë‚´ê¸°
        async function testCurrentPrices() {
            try {
                // í˜„ì¬ ê°€ê²© ê°€ì ¸ì˜¤ê¸°
                const binanceResponse = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr?symbol=XPLUSDT');
                const binanceData = await binanceResponse.json();
                const binancePrice = parseFloat(binanceData.markPrice || binanceData.lastPrice);
                
                const hyperliquidResponse = await fetch('https://api.hyperliquid.xyz/info');
                const hyperliquidData = await hyperliquidResponse.json();
                const xplMeta = hyperliquidData.universe.find(meta => meta.name === 'XPL');
                const hyperliquidPrice = parseFloat(xplMeta.markPrice);
                
                // ê°­ ê³„ì‚°
                const gap = Math.abs(binancePrice - hyperliquidPrice);
                const gapPercentage = (gap / Math.min(binancePrice, hyperliquidPrice)) * 100;
                
                // í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ìƒì„±
                const testMessage = `ğŸ§ª <b>í˜„ì¬ ê°€ê²© í…ŒìŠ¤íŠ¸</b>\n\nBinance XPL: $${binancePrice.toFixed(6)}\nHyperliquid XPL: $${hyperliquidPrice.toFixed(6)}\nê°­: ${gapPercentage.toFixed(2)}%\n\nâ° ${new Date().toLocaleString('ko-KR')}`;
                
                // ë‘ ê·¸ë£¹ ëª¨ë‘ì— ì „ì†¡
                sendTelegramMessage(testMessage);
                sendTelegramMessageToGroup(testMessage, NEW_GROUP_CHAT_ID);
                
                console.log(`í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ!\n\nBinance: $${binancePrice.toFixed(6)}\nHyperliquid: $${hyperliquidPrice.toFixed(6)}\nê°­: ${gapPercentage.toFixed(2)}%`);
                
                console.log('í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡:', testMessage);
                
            } catch (error) {
                console.error('í…ŒìŠ¤íŠ¸ ì¤‘ ì˜¤ë¥˜:', error);
            }
        }
    </script>
</body>
</html>
